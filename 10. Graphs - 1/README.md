Задача A. Компоненты связности
ограничение по времени на тест
2 секунды
ограничение по памяти на тест
256 мегабайт
ввод
стандартный ввод
вывод
стандартный вывод

Дан неориентированный граф. Требуется выделить компоненты связности в нем.
Входные данные

Первая строка входного файла содержит два натуральных числа 𝑛
и 𝑚 — количество вершин и ребер графа соответственно (1≤𝑛≤100000, 0≤𝑚≤200000

).

Следующие 𝑚
строк содержат описание ребер по одному на строке. Ребро номер 𝑖 описывается двумя натуральными числами 𝑏𝑖, 𝑒𝑖 — номерами концов ребра (1≤𝑏𝑖,𝑒𝑖≤𝑛

). Допускаются петли и параллельные ребра.
Выходные данные

В первой строке выходного файла выведите целое число 𝑘
 — количество компонент связности графа. Во второй строке выведите 𝑛 натуральных чисел 𝑎1,𝑎1,…,𝑎𝑛, не превосходящих 𝑘, где 𝑎𝑖 — номер компоненты связности, которой принадлежит 𝑖-я вершина.




Задача B Репосты
ограничение по времени на тест
1 секунда
ограничение по памяти на тест
256 мегабайт
ввод
стандартный ввод
вывод
стандартный вывод

Однажды Поликарп опубликовал в социальной сети смешную картинку с опросом про цвет своего хэндла. Многие из его друзей стали репостить шутку Поликарпа себе в ленту. Некоторые из них репостили репосты и так далее.

Эти события заданы в виде последовательности строк «name1 reposted name2» где name1 — это имя того, кто репостнул, а name2 — имя того, с чей ленты репостнули шутку. Гарантируется, что для каждой строки «name1 reposted name2» пользователь «name1» еще не имел эту шутку в свой ленте, а «name2» уже имел ее в своей ленте к моменту репоста. Поликарп зарегистрирован под именем «Polycarp», и изначально шутка есть только в его ленте.

Поликарп измеряет успешность шутки как длину наибольшей цепочки репостов. Выведите успешность шутки Поликарпа.
Входные данные

В первой строке входных данных записано целое число n (1 ≤ n ≤ 200) — количество репостов. Далее записаны сами репосты в порядке их совершения. Каждый из них записан в отдельной строке и имеет вид «name1 reposted name2». Все имена во входных данных состоят из прописных или строчных латинских букв и/или цифр и имеют длины от 2 до 24 символов включительно.

Известно, что имена пользователей регистронезависимы, то есть два имени, отличающиеся исключительно регистром букв, соответствуют одному и тому же пользователю соцсети.
Выходные данные

Выведите единственное целое число — максимальную длину цепочки репостов.




Задача C Топологическая сортировка
ограничение по времени на тест
2 секунды
ограничение по памяти на тест
256 мегабайт
ввод
стандартный ввод
вывод
стандартный вывод

Дан ориентированный невзвешенный граф. Необходимо построить его топологическую сортирвоку.
Входные данные

В первой строке входного файла даны два натуральных числа 𝑛
и 𝑚 (1≤𝑛≤100000, 0≤𝑚≤100000) — число вершин и рёбер в графе соответственно. Далее в 𝑚

строках перечислены рёбра графа. Каждое ребро задаётся парой чисел — номерами начальной и конечной вершин соответственно.
Выходные данные

Выведите любую топологическую сортировку графа в виде последовательности номеров вершин. Если граф невозможно топологически отсортировать, выведите −1
.



Задача D. Конденсация графа
ограничение по времени на тест
2 секунды
ограничение по памяти на тест
256 мегабайт
ввод
стандартный ввод
вывод
стандартный вывод

Конденсацией графа 𝐺
называется новый граф 𝐻, где каждой компоненте сильной связности в графе 𝐺 соответствует вершина из графа 𝐻. Ребро 𝑣𝑢 в графе 𝐻 есть тогда и только тогда, когда в графе 𝐺 существует хотя бы одно ребро из соответствующей 𝑣 компоненте сильной связности, в компоненту, соответствующую 𝑢

.

Требуется найти количество ребер в конденсации ориентированного графа.

Примечание: конденсация графа не содержит кратных ребер.
Входные данные

Первая строка входного файла содержит два натуральных числа 𝑛
и 𝑚 — количество вершин и ребер графа соответственно (𝑛≤10000, 𝑚≤100000). Следующие 𝑚 строк содержат описание ребер, по одному на строке. Ребро номер 𝑖 описывается двумя натуральными числами 𝑏𝑖, 𝑒𝑖 — началом и концом ребра соответственно (1 ≤ 𝑏𝑖, 𝑒𝑖 ≤ 𝑛

). В графе могут присутствовать кратные ребра и петли.
Выходные данные

Единственная строка выходного файла должна содержать одно число — количество ребер в конденсации графа.




Задача E. Точки сочленения
ограничение по времени на тест
2 секунды
ограничение по памяти на тест
256 мегабайт
ввод
стандартный ввод
вывод
стандартный вывод

Дан неориентированный граф. Требуется найти все точки сочленения в нём.
Входные данные

Первая строка входного файла содержит два натуральных числа 𝑛
и 𝑚 — количества вершин и рёбер графа соответственно (1⩽𝑛⩽20000, 1⩽𝑚⩽200000

).

Следующие 𝑚
 строк содержат описание рёбер по одному на строке. Ребро номер 𝑖 описывается двумя натуральными числами 𝑏𝑖, 𝑒𝑖 — номерами концов ребра (1⩽𝑏𝑖,𝑒𝑖⩽𝑛

).
Выходные данные

Первая строка выходного файла должна содержать одно натуральное число 𝑏
 — количество точек сочленения в заданном графе. На следующей строке выведите 𝑏 целых чисел — номера вершин, которые являются точками сочленения, в возрастающем порядке. 
